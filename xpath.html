<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Leon Yin">
<meta name="dcterms.date" content="2024-07-26">
<meta name="description" content="Why aren’t you using XPath? Get familar now!">

<title>XPath</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./best-practices-data-collection.html" rel="next">
<link href="./browser_automation.html" rel="prev">
<link href="./assets/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta property="og:title" content="XPath to Success">
<meta property="og:description" content="Why aren't you using XPath? Get familar now!">
<meta property="og:image" content="https://inspectelement.org/assets/inspect-element-logo.jpg">
<meta property="og:site-name" content="Inspect Element">
<meta property="og:locale" content="us_EN">
<meta name="twitter:title" content="XPath to Success">
<meta name="twitter:description" content="Why aren't you using XPath? Get familar now!">
<meta name="twitter:image" content="https://inspectelement.org/assets/inspect-element-logo.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-title">Parsing HTML with XPath</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Inspect Element</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/yinleon/inspect-element" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./start.html" class="sidebar-item-text sidebar-link">Planning investigations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./checklist.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Checklist</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./build-your-own-datasets.html" class="sidebar-item-text sidebar-link">Build your own datasets</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Undocumented APIs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./browser_automation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Browser automation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./xpath.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Parsing with Xpath</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./best-practices-data-collection.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Best practices</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-xpath" id="toc-introduction-to-xpath" class="nav-link active" data-scroll-target="#introduction-to-xpath">Introduction to XPath</a>
  <ul class="collapse">
  <li><a href="#what-is-xpath" id="toc-what-is-xpath" class="nav-link" data-scroll-target="#what-is-xpath">What is XPath?</a></li>
  <li><a href="#identifying-the-optimal-xpath-in-the-browser" id="toc-identifying-the-optimal-xpath-in-the-browser" class="nav-link" data-scroll-target="#identifying-the-optimal-xpath-in-the-browser">Identifying the optimal XPath in the browser</a></li>
  <li><a href="#text-matching" id="toc-text-matching" class="nav-link" data-scroll-target="#text-matching">Text Matching</a></li>
  </ul></li>
  <li><a href="#web-parsing-with-xpath" id="toc-web-parsing-with-xpath" class="nav-link" data-scroll-target="#web-parsing-with-xpath">Web Parsing with XPath</a>
  <ul class="collapse">
  <li><a href="#static-html" id="toc-static-html" class="nav-link" data-scroll-target="#static-html">Static HTML</a></li>
  <li><a href="#compared-to-beautifulsoup" id="toc-compared-to-beautifulsoup" class="nav-link" data-scroll-target="#compared-to-beautifulsoup">Compared to BeautifulSoup</a></li>
  <li><a href="#the-same-example-using-xpath" id="toc-the-same-example-using-xpath" class="nav-link" data-scroll-target="#the-same-example-using-xpath">The same example using xpath</a></li>
  <li><a href="#browser-automation" id="toc-browser-automation" class="nav-link" data-scroll-target="#browser-automation">Browser Automation</a></li>
  </ul></li>
  <li><a href="#equivalent-functions-across-frameworks" id="toc-equivalent-functions-across-frameworks" class="nav-link" data-scroll-target="#equivalent-functions-across-frameworks">Equivalent functions across frameworks</a>
  <ul class="collapse">
  <li><a href="#when-things-get-more-complicated" id="toc-when-things-get-more-complicated" class="nav-link" data-scroll-target="#when-things-get-more-complicated">When things get more complicated</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/yinleon/inspect-element/blob/main/xpath.ipynb" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Parsing HTML with XPath</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Leon Yin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 26, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">July 7, 2025</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<p><a type="button" class="btn btn-outline-primary btn-sm" target="_blank" href="https://inspectelement.org/xpath">📖 Read online</a> <a type="button" class="btn btn-outline-primary btn-sm" target="_blank" href="https://colab.research.google.com/github/yinleon/inspect-element/blob/main/xpath.ipynb">🖥️ Interactive version</a> <a type="button" class="btn btn-outline-primary btn-sm" target="_blank" href="https://github.com/yinleon/inspect-element/blob/main/xpath.ipynb">⚙️ GitHub</a> <a type="button" class="btn btn-outline-primary btn-sm" target="_self" href="apis.html#citation">🏛 Citation</a> <br></p>
</div>
</div>
<p><a href="https://en.wikipedia.org/wiki/XPath">XPath</a> is an expression language used to parse and navigate <a href="https://en.wikipedia.org/wiki/XML">XML</a>-formatted documents such as HTML.</p>
<p>XPath is useful for web scraping and can be used in place of the popular <a href="https://beautiful-soup-4.readthedocs.io/en/latest/">BeautifulSoup</a> Python package.</p>
<p>A key advantage of XPath is its universality. The same selectors will work across browsers and web scraping tools, which smoothes the lines between inspecting live websites, writing code to pull data from HTML pages, and identifying specific web elements to interact with using <a href="./browser_automation.html">browser automation</a> tools.</p>
<p>This section will teach you how to write simple, precise, and generalizable XPath expressions to parse and manipulate web pages.</p>
<section id="introduction-to-xpath" class="level1">
<h1>Introduction to XPath</h1>
<p>We’re going to identify all the recent article titles and links from NPR. In your browser and go to our example website: https://text.npr.org/</p>
<p>Next, open the dev tools by right-clicking anywhere and selecting “Inspect” (or however else).</p>
<p>Select any element in the “Elements” tab and copy the XPath:</p>
<figure class="figure">
<img src="assets/xpath_devtools.png" width="75%" class="figure-img">
<figcaption align="left" style="font-size:80%;" class="figure-caption">
How to copy the xpath of an element in Dev Tools.
</figcaption>
</figure>
<p>The element we’re selecting is an <code>&lt;a&gt;</code> tag with a link and a title that looks like this:</p>
<pre><code>&lt;a class="topic-title" href="/nx-s1-5035272"&gt;What is in Project 2025? &lt;/a&gt;</code></pre>
<p>The resulting XPath that we copied looks like this:</p>
<pre><code>/html/body/main/div/ul/li[1]/a</code></pre>
<section id="what-is-xpath" class="level3">
<h3 class="anchored" data-anchor-id="what-is-xpath">What is XPath?</h3>
<p>XPath records hierarchically across a cascade of HTML tags, with the last tag denoting the destination.</p>
<p>It designates where an element lives in an HTML document (as if you were honing in on a street address from the center of the earth).</p>
<p>The example above is long and specific to one element on the page (BAD!). It is called an <em>absolute XPath</em>.</p>
<p>Absolute XPath provides directions to a <em>specifc</em> destination (for example the Shake Shack in Madison Square). However, there’s another form of XPath called a <em>relative XPath</em> that can provide directions to <em>every</em> Shake Shack.</p>
<p>With a little practice XPath can be both precise and generalizable, providing an elegant way to locate and select elements from web pages.</p>
<p>Here is the other extreme: short and generic (ALSO BAD!!).</p>
<pre><code>//a</code></pre>
<p>This <em>relative XPath</em> syntax yields the target element mixed with every other element on the page with an <code>&lt;a&gt;</code> tag. Following the Shake Shack analogy, this XPath represents directions to every restaurant on Earth.</p>
<p>You’ll notice the “//” before the <code>&lt;a&gt;</code> tag, which denotes a search <em>anywhere</em> on the page.</p>
</section>
<section id="identifying-the-optimal-xpath-in-the-browser" class="level3">
<h3 class="anchored" data-anchor-id="identifying-the-optimal-xpath-in-the-browser">Identifying the optimal XPath in the browser</h3>
<p>A key strength of XPath is that you can identify and refine them <em>in browser</em>, and use the same XPath in different frameworks to make web parsing a breeze.</p>
<p>The Goldie Locks approach is not about specifying the exact route (absolute XPath), but rather identifying the destinguishing attributes of the destination (a precise relative XPath).</p>
<p>Let’s jump back to the live <a href="https://text.npr.org/">NPR website</a>:</p>
<ol type="1">
<li><p>In Dev Tools, switch over to the “console” tab. This allows us to execute JavaScript on the page.</p></li>
<li><p>We’ll use the <code>$x()</code> <a href="https://developer.chrome.com/docs/devtools/console/utilities#xpath-function">function</a> to select elements on the page by xpath (“x” for <strong>x</strong>path). This is unique to devtools and not a standard JavaScript function.</p></li>
</ol>
<p>As a start, type a HTML tag such as a “header”, “a”, “div”:</p>
<pre><code>$x('//a')</code></pre>
<p>XPath offers an easy way specify attributes and other distinguishable features.</p>
<p>You just add an “@” sign before the attribute name. This allows you to denote specific attribute values <code>//a[@href="/nx-s1-5035272"]</code> or simply the presence of an attribute <code>//a[@href]</code>.</p>
<p>Here’s a workflow for honing in to the optimal XPath:</p>
<ul>
<li>Start a XPath with a HTML tag with closed brackets: <code>//a[ ... ]</code></li>
<li>copy + paste attributes from a live element (for example <code>&lt;a class="topic-title" href="/nx-s1-5035272"&gt;</code>)</li>
<li>Add “@” before each attribute, ending up with: <code>//a[@class="topic-title" and @href="/nx-s1-5035272"]</code>.</li>
</ul>
<p>From there, you can remove overly-specific attributes. In the case above, the <code>class</code> is unique enough to isolate news articles.</p>
<pre><code>$x('//a[@class="topic-title"]')</code></pre>
<p>When available, identify elements using accessibility features (<code>aria</code>) or <code>data</code> attributes. These are less subject to change and are easy to read.</p>
</section>
<section id="text-matching" class="level2">
<h2 class="anchored" data-anchor-id="text-matching">Text Matching</h2>
<p>XPath also allows for text-matching.</p>
<p>Here’s how you can match for a link on the page with text mentioning “2025”</p>
<pre><code>$x('//a[@href and contains(text(),"2025")]')</code></pre>
<p>To sanity check your results, you can expand the resulting list and click any of the elements. This will highlight the element on the page and shoot you back to the Dev Tools “Elements” tab to view the element.</p>
<video width="100%" controls="" loop="">
<source src="assets/xpath_simple.mp4" type="video/mp4">
</video>
</section>
</section>
<section id="web-parsing-with-xpath" class="level1">
<h1>Web Parsing with XPath</h1>
<section id="static-html" class="level2">
<h2 class="anchored" data-anchor-id="static-html">Static HTML</h2>
<p>With the correct xpath in hand, we can automate this parsing in Python.</p>
<p>Let’s visit the website and retrieve the static HTML from the page.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://text.npr.org/"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>resp <span class="op">=</span> requests.get(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compared-to-beautifulsoup" class="level2">
<h2 class="anchored" data-anchor-id="compared-to-beautifulsoup">Compared to BeautifulSoup</h2>
<p>If you’re familar with <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">BeautifulSoup</a>, we’re going to be doing the same steps as below. In both cases we’ll search unique patterns between the element tags, classes, <code>data</code> attributes, and other features to isolate the correct elements.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># read the webpage as bs4</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> BeautifulSoup(resp.text)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># select all the "a" tags with the specified class.</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>articles <span class="op">=</span> soup.find_all(<span class="st">"a"</span>, {<span class="st">"class"</span>: <span class="st">"topic-title"</span>})</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate through each headline and grab the title and link of each story.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> elm <span class="kw">in</span> articles:</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    link <span class="op">=</span> elm.get(<span class="st">'href'</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    link <span class="op">=</span> <span class="ss">f"https://npr.org</span><span class="sc">{</span>link<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> elm.text</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> {<span class="st">'link'</span> : link, <span class="st">'title'</span>: title}</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    data.append(row)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>data[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[{'link': 'https://npr.org/nx-s1-5458512',
  'title': 'How good was the forecast? Texas officials and the National Weather Service disagree'},
 {'link': 'https://npr.org/nx-s1-5458514',
  'title': 'Texas officials race to find survivors after devastating floods '},
 {'link': 'https://npr.org/nx-s1-5457278',
  'title': 'At least 78 dead and dozens missing after catastrophic Texas flooding '},
 {'link': 'https://npr.org/nx-s1-5454890',
  'title': '4 things to know about the vaccine ingredient thimerosal'},
 {'link': 'https://npr.org/g-s1-75874',
  'title': 'Knives, bullets and thieves: the quest for food in Gaza'}]</code></pre>
</div>
</div>
</section>
<section id="the-same-example-using-xpath" class="level2">
<h2 class="anchored" data-anchor-id="the-same-example-using-xpath">The same example using xpath</h2>
<p>Here we’ll read the HTML into <a href="https://lxml.de/">lxml</a> to parse elements based on xpath. Note: some frameworks prefer the <code>.//</code> relative syntax (lxml) compared to <code>//</code> (Playwright).</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lxml <span class="im">import</span> etree</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># read the webpage as lxml</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> etree.HTML(resp.text)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># select all the "a" tags with the specified class.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>xpath_article <span class="op">=</span> <span class="st">'.//a[@class="topic-title"]'</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>elements <span class="op">=</span> tree.findall(xpath_article)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate through each headline and grab the title and link of each story.</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> elm <span class="kw">in</span> elements:</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    link <span class="op">=</span> elm.get(<span class="st">'href'</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    link <span class="op">=</span> <span class="ss">f"https://npr.org</span><span class="sc">{</span>link<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> elm.text</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> {<span class="st">'link'</span> : link, <span class="st">'title'</span>: title}</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    data.append(row)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>data[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>[{'link': 'https://npr.org/nx-s1-5458512',
  'title': 'How good was the forecast? Texas officials and the National Weather Service disagree'},
 {'link': 'https://npr.org/nx-s1-5458514',
  'title': 'Texas officials race to find survivors after devastating floods '},
 {'link': 'https://npr.org/nx-s1-5457278',
  'title': 'At least 78 dead and dozens missing after catastrophic Texas flooding '},
 {'link': 'https://npr.org/nx-s1-5454890',
  'title': '4 things to know about the vaccine ingredient thimerosal'},
 {'link': 'https://npr.org/g-s1-75874',
  'title': 'Knives, bullets and thieves: the quest for food in Gaza'}]</code></pre>
</div>
</div>
<p>The outcome is the same between BeautifulSoup and lxml. However BeautifulSoup only works with static HTML you’ve saved or stored in memory.</p>
<p>XPath can be used to parse data in this format, but also can be used to work in browser automation frameworks.</p>
</section>
<section id="browser-automation" class="level2">
<h2 class="anchored" data-anchor-id="browser-automation">Browser Automation</h2>
<p>The same xpath can be used for browser automation frameworks, such as Playwright.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># download software</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install playwright</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>playwright install</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: playwright in /Users/leon/miniconda3/lib/python3.7/site-packages (1.35.0)
Requirement already satisfied: pyee==9.0.4 in /Users/leon/miniconda3/lib/python3.7/site-packages (from playwright) (9.0.4)
Requirement already satisfied: typing-extensions in /Users/leon/miniconda3/lib/python3.7/site-packages (from playwright) (3.7.4.3)
Requirement already satisfied: greenlet==2.0.2 in /Users/leon/miniconda3/lib/python3.7/site-packages (from playwright) (2.0.2)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> playwright.async_api <span class="im">import</span> async_playwright</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>playwright <span class="op">=</span> <span class="cf">await</span> async_playwright().start()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>browser <span class="op">=</span> <span class="cf">await</span> playwright.chromium.launch(headless <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>page <span class="op">=</span> <span class="cf">await</span> browser.new_page()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The exact function to use XPath is a little different across scraping tools (‘locator’ in the case of Playwright), but the XPath expressions stay the same.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># go to the webpage,</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> page.goto(url)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># we use xpath in the `locator` function to select all the articles.</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>xpath_article <span class="op">=</span> <span class="st">'//a[@class="topic-title"]'</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>elms <span class="op">=</span> <span class="cf">await</span> page.locator(xpath_article).<span class="bu">all</span>()</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate through each headline and grab the title and link of each story.</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> elm <span class="kw">in</span> elms:</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="cf">await</span> elm.text_content()</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    link <span class="op">=</span> <span class="cf">await</span> elm.get_attribute(<span class="st">'href'</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    link <span class="op">=</span> <span class="ss">f'https://npr.org</span><span class="sc">{</span>link<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> {<span class="st">'link'</span>: link, <span class="st">'title'</span>: title,}</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    data.append(row)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>data[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>[{'link': 'https://npr.org/nx-s1-5458512',
  'title': 'How good was the forecast? Texas officials and the National Weather Service disagree'},
 {'link': 'https://npr.org/nx-s1-5458514',
  'title': 'Texas officials race to find survivors after devastating floods '},
 {'link': 'https://npr.org/nx-s1-5457278',
  'title': 'At least 78 dead and dozens missing after catastrophic Texas flooding '},
 {'link': 'https://npr.org/nx-s1-5454890',
  'title': '4 things to know about the vaccine ingredient thimerosal'},
 {'link': 'https://npr.org/g-s1-75874',
  'title': 'Knives, bullets and thieves: the quest for food in Gaza'}]</code></pre>
</div>
</div>
<p>To review, here is how we would find all the article elements across the frameworks we mentioned…</p>
</section>
</section>
<section id="equivalent-functions-across-frameworks" class="level1">
<h1>Equivalent functions across frameworks</h1>
<table class="table">
<colgroup>
<col style="width: 21%">
<col style="width: 15%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Framework</th>
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bs4</td>
<td style="text-align: left;"><code>find_all</code></td>
<td style="text-align: left;"><code>soup.find_all("a", {"class": "topic-title"})</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Browser console</td>
<td style="text-align: left;"><code>$x</code></td>
<td style="text-align: left;"><code>$x('//a[@class="topic-title"]')</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">lxml</td>
<td style="text-align: left;"><code>findall</code></td>
<td style="text-align: left;"><code>tree.findall('//a[@class="topic-title"]')</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Playwright</td>
<td style="text-align: left;"><code>locator</code></td>
<td style="text-align: left;"><code>page.locator('//a[@class="topic-title"]').all()</code></td>
</tr>
</tbody>
</table>
<section id="when-things-get-more-complicated" class="level2">
<h2 class="anchored" data-anchor-id="when-things-get-more-complicated">When things get more complicated</h2>
<p>We exhibited XPath’s basic functionality on a simple static HTML page. It really shines when it comes to breaking down a complicated website</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./browser_automation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Browser automation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./best-practices-data-collection.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Best practices</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>